{% extends 'base.html.twig' %}

{% block title %}Accueil{% endblock %}

{% block body %}
    <h1>Accueil</h1>


    {% if currentPage > 1 %}
        <a href="{{ path('outing', {'page':currentPage-1}) }}"> {{ currentPage-1 }} | Page précédente</a>
    {% endif %}


    <a href="{{ path('outing', {'page':currentPage+1}) }}"> Page suivante | {{ currentPage + 1 }}</a>

    <div>  <P> Date du jour : {{ "now"|date("d/m/Y")  }} </P>
       {% if user is defined and user is not null %}
           <P> Participant: {{ user.firstname }} </P>
        {% endif %}
    </div>


    <div>

        {{ form_start(formulaire) }}
        <div class = "formulaire">
            <div class = "formulaireLine">
                <div class ="labelinput">
                    <div class=" label"> {{ form_label(formulaire.site) }} </div>
                    <div class=" input"> {{ form_widget(formulaire.site)}} </div>
                </div >

                <div class = "error"> {{ form_errors(formulaire.site) }} </div>
            </div>

            <div class = "formulaireLine">
                <div class ="labelinput">
                    <div class="label"> {{ form_label(formulaire.name) }} </div>
                    <div class="input"> {{ form_widget(formulaire.name)}} </div>
                </div >

                <div class = "error"> {{ form_errors(formulaire.name) }} </div>
            </div>


            <div class = "formulaireLine">
                <div class = "labelinput">
                    <div class = "label"> {{ form_label(formulaire.dateBegin) }} </div>
                    <div class = "input"> {{ form_widget(formulaire.dateBegin)}} </div>
                </div >

                <div class = "error"> {{ form_errors(formulaire.dateBegin) }} </div>
            </div>

            <div class = "formulaireLine">
                <div class = "labelinput">
                    <div class="label"> {{ form_label(formulaire.dateEnd) }} </div>
                    <div class = "input"> {{ form_widget(formulaire.dateEnd)}} </div>
                </div >

                <div class = "error"> {{ form_errors(formulaire.dateEnd) }} </div>
            </div>

            <div class = "formulaireLine">
                <div class = "labelinput">
                    <div class = "input"> {{ form_widget(formulaire.isPlanner)}} </div>
                    <div class = "label"> {{ form_label(formulaire.isPlanner) }} </div>

                </div >

                <div class = "error"> {{ form_errors(formulaire.isPlanner) }} </div>
            </div>


            <div class = "formulaireLine">
                <div class = "labelinput">
                    <div class = "label"> {{ form_label(formulaire.isRegistered) }} </div>
                    <div class = "input"> {{ form_widget(formulaire.isRegistered)}} </div>
                </div >

                <div class = "error"> {{ form_errors(formulaire.isRegistered) }} </div>
            </div>

            <div class = "formulaireLine">
                <div class = "labelinput">
                    <div class = "label"> {{ form_label(formulaire.isNotRegistered) }} </div>
                    <div class = "input"> {{ form_widget(formulaire.isNotRegistered)}} </div>
                </div >

                <div class = "error"> {{ form_errors(formulaire.isNotRegistered) }} </div>
            </div>

            <div class = "formulaireLine" >
                <div class = "labelinput">
                    <div class = "label"> {{ form_label(formulaire.isOutDated) }}    </div>
                    <div class = "input"  >  {{ form_widget(formulaire.isOutDated)}}   </div>
                </div >

                <div class = "error">  {{ form_errors(formulaire.isOutDated)}}  </div>
            </div>





        </div>



        {{  form_end (formulaire)}}



    </div>



    <div>

            <table>
                <thead>
                <tr>
                    <th colspan="2">Nom de la sortie</th>
                    <th colspan="2">Date de la sortie</th>
                    <th colspan="2">Clôture</th>
                    <th colspan="2">inscrits/places</th>
                    <th colspan="2">Etat</th>
                    <th colspan="2">Inscrit</th>
                    <th colspan="2">Organisateur</th>
                    <th colspan="2">Actions</th>
                </tr>
                </thead>
                <tbody>
    {% set isBooked = '' %}
     {% for outing in outings %}
         {% if user is defined and user is not null %}
            {% set listParticipants= outing.participants %}

            {% for participant in listParticipants %}
                {% if user.pseudo  is same as (participant.pseudo) %}

                    {% set isBooked = 'X' %}

                {% endif %}


            {%  endfor %}
         {% endif %}
                <tr>
                    <td colspan="2">{{ outing.name}}</td>
                    <td colspan="2">{{ outing.dateBegin|date ('d/m/y')}}</td>
                    <td colspan="2">{{ outing.dateBegin|date_modify('+'~outing.duration ~ 'day')|date ('d/m/y')}}</td>
                    <td colspan="2">{{ outing.participants|length}} / {{ outing.maxRegistration }}</td>
                    <td colspan="2">{{ outing.state.label}}</td>
                    <td colspan="2"> {{ isBooked }}</td>
                    <td colspan="2">{{ outing.planner.lastName}} </td>
                    <td colspan="2"> <div class="action_buttons">
                        <a href="{{ path('outing') }}"> afficher </a>
                        <a href="{{ path('outing') }}"> Se desister </a>
                        <a href="{{ path('outing') }}">   S'inscrire </a>
                        <a href="{{ path('outing') }}"> Modifier </a>
                        <a href="{{ path('outing') }}"> Annuler  </a> </div>
                    </td>


                </tr>

    {%  endfor %}
                </tbody>
            </table>

        </div>
    <p> <a href="{{ path('outing') }}"> Créer une sortie </a></p>

    <p> Page n° {{ currentPage}}</p>


{% endblock %}
